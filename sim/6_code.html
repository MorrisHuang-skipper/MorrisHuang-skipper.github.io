<!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #008000"># 2020/1/12 Morris</span>

    <span style="color: #008000"># import package</span>
    <span style="color: #0000ff">from</span> vpython <span style="color: #0000ff">import</span> *
    
    <span style="color: #008000"># parameter setting</span>
    k = 9E9                 <span style="color: #008000"># Coulomb constant</span>
    ec = 1.6E-19            <span style="color: #008000"># electron charge</span>
    radius = 1.2E-14        <span style="color: #008000"># radius of charge</span>
    field = []              <span style="color: #008000"># store electric field arrow</span>
    arrow_length = 3E-14    <span style="color: #008000"># length of arrow</span>
    
    <span style="color: #0000ff">def</span> main():
        <span style="color: #008000"># create scene and object</span>
        scene = canvas(width=1000, height=600, align=<span style="color: #a31515">&#39;left&#39;</span>, range=3E-13)
    
        Create_Charge(vec(0, 0, 0), 1)
    
        <span style="color: #008000"># generate electric field</span>
        <span style="color: #0000ff">for</span> r <span style="color: #0000ff">in</span> range(1, 30, 5):
            <span style="color: #0000ff">for</span> theta <span style="color: #0000ff">in</span> range(0, 6):
                <span style="color: #0000ff">for</span> phi <span style="color: #0000ff">in</span> range(0, 6):
                    position = Transform_Coordinate(radius*r, theta*pi/3, phi*pi/3)
                    Create_Field(position)
    
    <span style="color: #008000"># create charge</span>
    charges = []
    <span style="color: #0000ff">def</span> Create_Charge(pos, C):
        charge = sphere(pos=pos, radius=radius, coulomb=C*ec)
        charges.append(charge)
    
    <span style="color: #008000"># create electric field</span>
    <span style="color: #0000ff">def</span> Create_Field(pos):
        <span style="color: #008000"># calculate electric field (superposition property)</span>
        E = vec(0, 0, 0)
        <span style="color: #0000ff">for</span> charge <span style="color: #0000ff">in</span> charges:
            E += k*charge.coulomb*(pos-charge.pos)/mag(pos-charge.pos)**3
        <span style="color: #008000"># create electric field using arrow</span>
        color = Mapping(mag(E))
        field.append(arrow(pos=pos, axis=hat(E)*arrow_length, color=vec(color, 0, 1)))
    
    <span style="color: #008000"># coordinate transformation</span>
    <span style="color: #0000ff">def</span> Transform_Coordinate(r, theta, phi):
        x = r*sin(theta)*cos(phi)
        y = r*sin(theta)*sin(phi)
        z = r*cos(theta)
        <span style="color: #0000ff">return</span> vec(x, y, z)
    
    <span style="color: #008000"># mapping from (Inf, 0) to (1, 0)</span>
    <span style="color: #0000ff">def</span> Mapping(E):
        a = 1E-17
        <span style="color: #0000ff">return</span> 1-exp(-a*E)
    
    main()
    </pre></div>
    